/* ===========================
   KAMEN RIDER TYCOON THEME — Polished
   =========================== */
:root{
  --ty-green: #2ecc71;
  --ty-green-dark: #27ae60;
  --ty-green-glow: rgba(46,204,113,.45);

  --ty-silver: #dfe6e9;
  --ty-silver-dark: #b2bec3;

  --ty-bg: #f0f9f2;
  --ty-bg-strong: #e6f6ea;

  --ty-text: #13251a;
  --ty-muted: #4b6351;

  --radius: 14px;
  --shadow: 0 10px 30px rgba(0,0,0,.10);
  --maxw: 920px;

  /* đồng bộ với JS applyFont() */
  --reader-font-size: 18px;
}

/* ===== Base ===== */
*{ box-sizing: border-box; }
html,body{ height:100%; }
html{ scroll-padding-top: 72px; -webkit-text-size-adjust: 100%; }
body.rider-bg{
  margin:0;
  font-family: ui-sans-serif, system-ui, "Segoe UI", Roboto, Arial, sans-serif;
  line-height:1.8; font-size:18px;
  color: var(--ty-text);
  background: radial-gradient(1200px 800px at 50% -200px, #ffffff 0%, var(--ty-bg) 55%, #fff 100%);
}

/* ===== HERO (Header) ===== */
.rider-hero{
  position: relative;
  color:#fff;
  border-bottom: 3px solid rgba(255,255,255,.18);
  box-shadow: var(--shadow);
  overflow: hidden;
  isolation: isolate;
}
/* Lớp ảnh nền mờ */
.rider-hero::before{
  content:"";
  position:absolute; inset:0;
  background-image: var(--hero-cover-url);
  background-size: cover; background-position: center;
  filter: blur(22px) saturate(1.15) brightness(.78);
  transform: scale(1.15);
  opacity:.75;
  z-index:-2;
  transition: opacity .25s ease, filter .25s ease, transform .25s ease;
}
/* Lớp phủ gradient để chữ nổi hơn */
.rider-hero::after{
  content:"";
  position:absolute; inset:0;
  background:
    linear-gradient(180deg, rgba(0,0,0,.55), rgba(0,0,0,.22) 40%, rgba(0,0,0,.12) 100%),
    radial-gradient(800px 400px at 50% -100px, rgba(255,255,255,.12), transparent 60%);
  z-index:-1;
}
/* Ẩn nền mờ nếu chưa có ảnh */
.rider-hero:not([data-has-cover])::before{ opacity:0; }

.rider-hero__inner{
  max-width: var(--maxw);
  margin: 0 auto;
  display:flex; align-items:center; justify-content:center;
  padding: clamp(22px, 6vw, 48px) 16px 18px;
  text-align:center;
}

/* ===== Title — glass badge ===== */
.rider-title{
  margin:0;
  font-weight: 800;
  letter-spacing:.2px;
  line-height:1.15;
  color:#fff;
  text-shadow: 0 8px 24px rgba(0,0,0,.35);
}
.rpg-banner{
  display:inline-flex; align-items:center; justify-content:center;
  padding: 10px 18px;
  border-radius: 16px;
  backdrop-filter: blur(10px) saturate(120%);
  background: linear-gradient(180deg, rgba(255,255,255,.18), rgba(255,255,255,.08));
  border: 1px solid rgba(255,255,255,.28);
  box-shadow: 0 1px 0 rgba(255,255,255,.25) inset, 0 12px 28px rgba(0,0,0,.20);
}
@media (min-width:640px){
  .rider-title{ font-size: 34px; }
  .rpg-banner{ padding: 12px 22px; }
}
@media (max-width:639px){
  .rider-title{ font-size: 26px; }
  .rpg-banner{ padding: 9px 14px; border-radius: 14px; }
}

/* ===== BELT (Nav) ===== */
.rider-belt{
  position: sticky; top: 0; z-index: 30;
  margin-top: 10px;
  background: linear-gradient(90deg, rgba(255,255,255,.85), rgba(255,255,255,.75));
  box-shadow: 0 4px 14px rgba(0,0,0,.08);
  border-top: 1px solid rgba(255,255,255,.65);
  backdrop-filter: blur(8px) saturate(140%);
  -webkit-backdrop-filter: blur(8px) saturate(140%);
  padding: 10px 0 12px;
}
.rider-belt__core{
  width: 84px; height: 10px; border-radius: 0 0 10px 10px;
  margin: 0 auto; transform: translateY(-6px);
  background: linear-gradient(180deg, #ffffff, var(--ty-silver));
  box-shadow: 0 6px 12px rgba(0,0,0,.10);
}
.rider-belt__slots{
  display:flex; gap:10px; justify-content:center; margin: 2px 0 10px;
}
.slot{
  width: 36px; height: 8px; border-radius: 999px;
  background:#c7d3d9; box-shadow: inset 0 1px 0 rgba(255,255,255,.65);
}
.slot--red{ background: linear-gradient(180deg, #ffd7c4, #ff9d4d); }
.slot--green{ background: linear-gradient(180deg, #d8ffe8, #27ae60); }
.slot--silver{ background: linear-gradient(180deg, #f4f8f9, #b2bec3); }

.belt-actions{
  max-width: var(--maxw); margin:0 auto;
  display:flex; gap:12px; justify-content:center; flex-wrap:wrap;
  padding: 0 12px;
}

/* ===== Buttons ===== */
.btn{
  -webkit-tap-highlight-color:transparent;
  user-select:none;
  background:#fff; color: var(--ty-green-dark);
  border:2px solid rgba(39,174,96,.9);
  padding:12px 16px; border-radius:12px;
  cursor:pointer; font-size:15px; line-height:1;
  min-height: 44px;
  transition: transform .12s ease, box-shadow .2s ease, background .2s ease, color .2s ease;
  box-shadow: 0 6px 16px rgba(39,174,96,.10);
}
.btn:hover{
  background: linear-gradient(180deg, var(--ty-green), var(--ty-green-dark));
  color:#fff;
  box-shadow: 0 0 0 3px var(--ty-green-glow), 0 10px 24px rgba(39,174,96,.25);
}
.btn:active{ transform: translateY(1px) scale(.995); }

.btn--belt{ background:#fff; }
.btn--home{
  background: linear-gradient(180deg, var(--ty-green-dark), #1f9957);
  color:#fff; border-color: transparent;
}
.btn--home:hover{
  background: linear-gradient(180deg, var(--ty-green), var(--ty-green-dark));
}

/* ===== MAIN ===== */
.rider-container{
  max-width: var(--maxw);
  margin: 22px auto 26px; padding: 0 16px;
}
.rider-reader{
  background:#fff; color: var(--ty-text);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  border:1px solid #edf4ee;
  padding: clamp(18px, 2.8vw, 26px);
}
.reader-header{
  display:flex; align-items:center; gap:12px; flex-wrap:wrap;
  border-bottom:1px solid #e9f3ec;
  padding-bottom:10px; margin-bottom:14px;
}
.reader-title{ margin:0; font-weight:800; color: var(--ty-green-dark); }

.reader-content{
  white-space: pre-line;
  text-align: justify;
  color: var(--ty-text);
  line-height:1.95;
  font-size: var(--reader-font-size);
  margin-bottom: 16px;
  word-break: break-word;
}
.reader-content p{ margin: .6em 0; }
.reader-content img{
  max-width: 100%; height: auto; display: block; margin: 14px auto;
  border-radius: 10px; box-shadow: 0 10px 24px rgba(0,0,0,.08);
}

/* ===== Progress ===== */
.read-progress{
  height:8px; width:100%; border-radius:999px; overflow:hidden;
  background: #e8f1ec; margin: 14px 0;
  box-shadow: inset 0 1px 0 rgba(255,255,255,.7);
}
.read-progress__bar{
  height:100%; width:0%;
  background: linear-gradient(90deg, #34d07b, #1fa75d);
  transition: width .2s ease;
}

/* ===== Tools ===== */
.reader-tools{
  display:flex; justify-content:center; gap:10px; flex-wrap:wrap;
}

/* ===== Điều hướng cuối chương ===== */
.reader-endnav{
  display:flex; justify-content:center; gap:12px; flex-wrap:wrap;
  margin: 16px 0 6px; padding: 14px;
  border-radius: 14px;
  background: linear-gradient(90deg, rgba(223,230,233,.85), rgba(178,190,195,.85));
  box-shadow: inset 0 -2px 6px rgba(0,0,0,.08), var(--shadow);
  position: relative;
  backdrop-filter: blur(6px);
}
.reader-endnav::before{
  content:"";
  width: 44px; height: 10px; border-radius: 999px;
  background: linear-gradient(180deg, #ffffff, var(--ty-silver-dark));
  position: absolute; top: -6px; left: 50%; transform: translateX(-50%);
  box-shadow: 0 6px 10px rgba(0,0,0,.08);
}
.reader-endnav .btn{
  background:#fff; color: var(--ty-green-dark);
  border:2px solid rgba(39,174,96,.9);
}
.reader-endnav .btn:hover{
  background: linear-gradient(180deg, var(--ty-green), var(--ty-green-dark));
  color:#fff;
}

/* ===== FOOTER ===== */
.rider-footer{
  text-align:center; color: var(--ty-muted);
  font-size:13px; padding: 10px 16px 28px;
}
.rider-tag{ letter-spacing:.12em; text-transform:uppercase; opacity:.75; }

/* ===== Modal ===== */
.chapter-modal{
  position: fixed; inset: 0;
  background: rgba(0,0,0,.25);
  display: grid; place-items: center;
  z-index: 50;
}
.chapter-modal__dialog{
  width: min(720px, 92vw);
  background: #fff;
  border-radius: 14px;
  box-shadow: 0 16px 36px rgba(0,0,0,.18);
  border: 1px solid #edf4ee;
  color: var(--ty-text);
  max-height: 88vh; display:flex; flex-direction: column;
}
.chapter-modal__header{
  display: flex; align-items: center; justify-content: space-between;
  padding: 12px 16px;
  border-bottom: 1px solid #e9f3ec;
  position: sticky; top:0; background:#fff; z-index:1;
}
.chapter-modal__list{
  list-style: none; margin: 0; padding: 8px 12px 16px;
  overflow: auto; flex:1;
}
.chapter-link-item{ margin: 6px 0; }
.chapter-link-btn{
  width: 100%; text-align: left;
  display: flex; gap: 10px; align-items: center;
  padding: 12px 14px;
  background: #fff;
  border: 2px solid rgba(39,174,96,.9);
  color: var(--ty-green-dark);
  border-radius: 12px;
  cursor: pointer;
  transition: transform .12s ease, box-shadow .2s ease, background .2s ease, color .2s ease;
  min-height: 44px;
  box-shadow: 0 6px 16px rgba(39,174,96,.08);
}
.chapter-link-btn:hover{
  background: linear-gradient(180deg, var(--ty-green), var(--ty-green-dark));
  color: #fff;
  box-shadow: 0 0 0 3px var(--ty-green-glow), 0 12px 24px rgba(39,174,96,.22);
}
.chapter-link-btn:active{ transform: translateY(1px) scale(.995); }
.chapter-link-index{ width: 32px; opacity: .75; }
.chapter-link-title{ flex: 1; }
.chapter-modal[hidden]{ display:none !important; }

@media (max-width: 560px){
  .chapter-modal__dialog{
    width: 100vw; height: 92vh; border-radius: 0;
  }
}

/* ===========================
   RESPONSIVE / FULL-BLEED
   =========================== */
@media (max-width: 900px){
  .rider-title{ font-size:26px; }
}
@media (max-width: 640px){
  :root{ --reader-font-size: 19px; }

  .rider-container{
    max-width: none;
    margin: 0;
    padding-left: max(0px, env(safe-area-inset-left));
    padding-right: max(0px, env(safe-area-inset-right));
  }
  .rider-reader{
    border-radius: 0; box-shadow: none;
    border-left: 0; border-right: 0;
    background: linear-gradient(180deg, var(--ty-bg-strong), #ffffff);
    padding: 18px clamp(12px, 4vw, 20px);
    padding-left: max(clamp(12px, 4vw, 20px), env(safe-area-inset-left));
    padding-right: max(clamp(12px, 4vw, 20px), env(safe-area-inset-right));
  }
  .rider-hero{
    padding-left: max(16px, env(safe-area-inset-left));
    padding-right: max(16px, env(safe-area-inset-right));
  }
  .rpg-banner{ font-size: 22px; }
  .belt-actions .btn{ flex:1 1 calc(50% - 12px); }
}
@media (max-width: 420px){
  .belt-actions .btn{ flex: 1 1 100%; }
}

/* ===== Dark theme ===== */
html[data-theme="kamenrider"] .rider-bg,
body.rider-bg.dark{
  background: radial-gradient(1200px 800px at 50% -200px, #0e1712 0%, #0b140e 60%, #0a0f0c 100%);
  color:#e6f9ee;
}
html[data-theme="kamenrider"] .rider-hero,
body.rider-bg.dark .rider-hero{
  border-bottom-color: rgba(255,255,255,.12);
}
html[data-theme="kamenrider"] .rider-belt,
body.rider-bg.dark .rider-belt,
html[data-theme="kamenrider"] .reader-endnav,
body.rider-bg.dark .reader-endnav{
  background: linear-gradient(90deg, rgba(199,210,214,.8), rgba(174,185,191,.8));
}
html[data-theme="kamenrider"] .rider-reader,
body.rider-bg.dark .rider-reader{
  background:#16231c; color:#e6f9ee; border-color:#22352a;
}
html[data-theme="kamenrider"] .btn,
body.rider-bg.dark .btn{
  background:#e6f9ee; color:#15452c; border-color:#1e7f4a;
}
html[data-theme="kamenrider"] .btn:hover,
body.rider-bg.dark .btn:hover{
  background: linear-gradient(180deg, var(--ty-green), var(--ty-green-dark));
  color:#fff;
}

/* ===== Hero nền ảnh mờ (hook JS) ===== */
.rider-hero .rider-hero__inner,
.rider-hero .rider-belt{ position: relative; z-index: 1; }


/* ===== Ảnh bìa trong Hero ===== */
#story-cover-img {
  max-width: 100px;          /* thu nhỏ bề ngang */
  max-height: 200px;         /* giữ tỷ lệ dọc hợp lý */
  border-radius: 12px;       /* bo góc mềm */
  object-fit: cover;         /* luôn vừa khung, không méo */
  box-shadow: 0 6px 18px rgba(0,0,0,.25);
  margin: 0 auto 16px;       /* căn giữa & cách tiêu đề */
  display: block;
}

/* Trên màn nhỏ hơn, ảnh bìa tự động nhỏ hơn */
@media (max-width: 640px){
  #story-cover-img {
    max-width: 90px;
    max-height: 120px;
    margin-bottom: 12px;
  }
}
